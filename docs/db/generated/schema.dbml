//// ------------------------------------------------------
//// THIS FILE WAS AUTOMATICALLY GENERATED (DO NOT MODIFY)
//// ------------------------------------------------------

Table users {
  id Int [pk, increment]
  password String [not null]
  firstName String [not null]
  lastName String
  email String [unique, not null]
  profilePictureName String [not null, default: 'default-avatar.png']
  isEmailVerified Boolean [not null, default: false]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [default: `now()`, not null]
  refreshTokenNonces refresh_token_nonces [not null]
  ownedCompany companies
}

Table refresh_token_nonces {
  id Int [pk, increment]
  userId Int [not null]
  nonce String [not null]
  createdAt DateTime [default: `now()`, not null]
  user users [not null]
}

Table companies {
  id Int [pk, increment]
  ownerId Int [unique, not null]
  email String [unique, not null]
  title String [not null]
  description String [not null]
  logoName String [not null, default: 'default-logo.png']
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [default: `now()`, not null]
  owner users [not null]
  events events [not null]
}

Table event_formats {
  id Int [pk, increment]
  title String [unique, not null]
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [default: `now()`, not null]
  events events [not null]
}

Table events {
  id Int [pk, increment]
  companyId Int [not null]
  formatId Int [not null]
  title String [not null]
  description String [not null]
  venue String [not null]
  locationCoordinates String [not null]
  startedAt DateTime [not null]
  endedAt DateTime [not null]
  publishedAt DateTime
  ticketsAvailableFrom DateTime
  posterName String [not null, default: 'default-poster.png']
  attendeeVisibility AttendeeVisibility [not null, default: 'EVERYONE']
  status EventStatus [not null, default: 'DRAFT']
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [default: `now()`, not null]
  company companies [not null]
  format event_formats [not null]
}

Enum AttendeeVisibility {
  EVERYONE
  ATTENDEES_ONLY
  NOBODY
}

Enum EventStatus {
  DRAFT
  PUBLISHED
  SALES_STARTED
  ONGOING
  FINISHED
  CANCELLED
}

Table tickets {
  id Int [pk, increment]
  eventId Int [not null]
  title String [not null]
  number String [unique, not null]
  price Decimal [not null, default: 0]
  status TicketStatus [not null, default: 'AVAILABLE']
  createdAt DateTime [default: `now()`, not null]
  updatedAt DateTime [default: `now()`, not null]
}

Enum TicketStatus {
  SOLD
  RESERVED
  AVAILABLE
}

Ref: refresh_token_nonces.userId > users.id [delete: Cascade]

Ref: companies.ownerId - users.id [delete: Restrict]

Ref: events.companyId > companies.id [delete: Restrict]

Ref: events.formatId > event_formats.id [delete: Restrict]
